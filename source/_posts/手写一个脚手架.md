---
title: æ‰‹å†™ä¸€ä¸ªè„šæ‰‹æ¶
date: 2021-07-28 21:43:06
tags 
  - Node
  - Npm
---


## åˆ›å»ºé¡¹ç›®

```shell
mkdir mingle-cli

cd mingle-cli

npm init -y

npm install commander download-git-repo ora handlebars figlet clear chanlk open -s
```



- command 
- download-git-repo
- ora
- handlebars
- figlet
- clear
- chanlk
- open





## é…ç½®ç›®å½•ç»“æ„



```shell
mkdir bin 

cd bin && touch mingle.js
```



ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
mingle-cli
â”œâ”€â”€ bin
â”‚Â Â  â””â”€â”€ mingle.js
â”œâ”€â”€ node_modules
â”œâ”€â”€ package-lock.json
â””â”€â”€ package.json
```





## é…ç½®package.json

package.jsonä¸­é…ç½®bin

```
  {
    "name": "mingle-cli",
    "version": "1.0.0",
    "description": "",
    "main": "mingle.js",
    "scripts": {
      "test": "echo \"Error: no test specified\" && exit 1"
    },
+   "bin": {
+     "mingle": "./bin/mingle.js"
+   },
    "keywords": [],
    "author": "",
    "license": "ISC",
    "dependencies": {
      "commander": "^8.1.0"
    }
  }

```



## ç¼–å†™ minglejs

```javascript
#!/usr/bin/env node		// å£°æ˜ç”¨nodeè§£æè¯¥æ–‡ä»¶

const { program } = require('commander');

program.version(require('../package.json').version);

program
    .command('new <name>')
    .description('new project')
    .action(require('../lib/new'));

console.log(process.argv);

program.parse(process.argv);

```





## é…ç½®å…¨å±€å‘½ä»¤

```shell
sudo npm link
```



æ‰§è¡ŒæˆåŠŸåï¼Œå¯ä»¥ä½¿ç”¨ ` mingle ` è¿™ä¸ªå…¨å±€å‘½ä»¤äº†.



<img src="http://cdn.chrischen.top/blog/l7e86J.png" style="zoom:67%;" />





## å®Œå–„ä»£ç 

lib/new.js

```javascript
const { promisify } = require('util');
const figlet = promisify(require('figlet'));
const clear = require('clear');
const chalk = require('chalk');
const log = content => console.log(chalk.green(content));
const { clone } = require('./download');

module.exports = async name => {
    // clear();
    const data = await figlet('MINGLE');
    log(data);
    
    log(`ğŸš— åˆ›å»ºé¡¹ç›® ${ name }`);
    await clone('https://github.com/ImChrisChen/blog.chrisorz.cn#master');
};
```





lib/download.js

```javascript
/**
 * Created by WebStorm.
 * User: chrischen
 * Date: 2021/7/28
 * Time: 22:14
 */

const { promisify } = require('util');
const ora = require('ora');
const download = promisify(require('download-git-repo'));

module.exports.clone = async function (repo, desc) {
    // const spinner = ora(`ğŸ„ğŸ¼ ä¸‹è½½... ${ repo }`).start();
    // console.log(spinner);
    // spinner.start();
    
    await download(repo, desc);
    console.log('ä¸‹è½½å®Œæˆ');
};
```



bin/mingle.js

```javascript
#!/usr/bin/env node

const { program } = require('commander');

program.version(require('../package.json').version);

program
    .command('new <name>')
    .description('new project')
    .action(require('../lib/new'));

console.log(process.argv);

program.parse(process.argv);
```



åˆ›å»ºä¸€ä¸ªåŸºäºmingleçš„è„šæ‰‹æ¶é¡¹ç›®

```javascript
mingle new mingle-cli
```



